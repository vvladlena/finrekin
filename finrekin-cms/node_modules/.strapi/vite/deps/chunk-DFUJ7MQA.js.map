{
  "version": 3,
  "sources": ["../../../@strapi/upload/admin/src/hooks/useTracking.ts", "../../../@strapi/upload/admin/src/hooks/useConfig.ts"],
  "sourcesContent": ["import {\n  useTracking as useStrapiTracking,\n  TrackingEvent,\n  useAIAvailability,\n} from '@strapi/admin/strapi-admin';\n\nimport { useSettings } from '../hooks/useSettings';\n\nexport const useTracking = () => {\n  const { trackUsage: trackStrapiUsage } = useStrapiTracking();\n  const { data } = useSettings();\n  const isAiAvailable = useAIAvailability();\n\n  const trackUsage = <TEvent extends TrackingEvent>(\n    event: TEvent['name'],\n    properties?: TEvent['properties']\n  ) => {\n    return trackStrapiUsage(event, {\n      ...properties,\n      ...(isAiAvailable ? { isAIMediaLibraryConfigured: Boolean(data?.aiMetadata) } : {}),\n    } as TEvent['properties']);\n  };\n\n  return { trackUsage };\n};\n", "import { useNotification, useFetchClient } from '@strapi/admin/strapi-admin';\nimport { useIntl } from 'react-intl';\nimport { useMutation, useQuery, UseMutationResult, UseQueryResult } from 'react-query';\n\nimport { GetConfiguration, UpdateConfiguration } from '../../../shared/contracts/configuration';\nimport { pluginId } from '../pluginId';\n\nimport { useTracking } from './useTracking';\n\nconst endpoint = `/${pluginId}/configuration`;\nconst queryKey = [pluginId, 'configuration'];\n\nexport const useConfig = () => {\n  const { trackUsage } = useTracking();\n  const { formatMessage } = useIntl();\n  const { toggleNotification } = useNotification();\n  const { get, put } = useFetchClient();\n\n  const config: UseQueryResult<\n    GetConfiguration.Response['data']['data'] | GetConfiguration.Response['error']\n  > = useQuery(\n    queryKey,\n    async () => {\n      const res: GetConfiguration.Response = await get(endpoint);\n\n      return res.data.data;\n    },\n    {\n      onError() {\n        return toggleNotification({\n          type: 'danger',\n          message: formatMessage({ id: 'notification.error' }),\n        });\n      },\n      /**\n       * We're cementing that we always expect an object to be returned.\n       */\n      select: (data) => data || {},\n    }\n  );\n\n  const putMutation: UseMutationResult<\n    void,\n    UpdateConfiguration.Response['error'],\n    UpdateConfiguration.Request['body']\n  > = useMutation(\n    async (body) => {\n      await put<UpdateConfiguration.Response>(endpoint, body);\n    },\n    {\n      onSuccess() {\n        trackUsage('didEditMediaLibraryConfig');\n        config.refetch();\n      },\n      onError() {\n        return toggleNotification({\n          type: 'danger',\n          message: formatMessage({ id: 'notification.error' }),\n        });\n      },\n    }\n  );\n\n  return {\n    config,\n    mutateConfig: putMutation,\n  };\n};\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;;;IAQaA,eAAc,MAAA;AACzB,QAAM,EAAEC,YAAYC,iBAAgB,IAAKC,YAAAA;AACzC,QAAM,EAAEC,KAAI,IAAKC,YAAAA;AACjB,QAAMC,gBAAgBC,kBAAAA;AAEtB,QAAMN,aAAa,CACjBO,OACAC,eAAAA;AAEA,WAAOP,iBAAiBM,OAAO;MAC7B,GAAGC;MACH,GAAIH,gBAAgB;QAAEI,4BAA4BC,QAAQP,6BAAMQ,UAAAA;MAAY,IAAI,CAAA;IAClF,CAAA;EACF;AAEA,SAAO;IAAEX;EAAW;AACtB;;;ACfA,IAAMY,WAAW,IAAIC,QAAAA;AACrB,IAAMC,WAAW;EAACD;EAAU;AAAgB;IAE/BE,YAAY,MAAA;AACvB,QAAM,EAAEC,WAAU,IAAKC,aAAAA;AACvB,QAAM,EAAEC,cAAa,IAAKC,QAAAA;AAC1B,QAAM,EAAEC,mBAAkB,IAAKC,gBAAAA;AAC/B,QAAM,EAAEC,KAAKC,IAAG,IAAKC,eAAAA;AAErB,QAAMC,SAEFC,SACFZ,UACA,YAAA;AACE,UAAMa,MAAiC,MAAML,IAAIV,QAAAA;AAEjD,WAAOe,IAAIC,KAAKA;KAElB;IACEC,UAAAA;AACE,aAAOT,mBAAmB;QACxBU,MAAM;QACNC,SAASb,cAAc;UAAEc,IAAI;QAAqB,CAAA;MACpD,CAAA;IACF;;;;IAIAC,QAAQ,CAACL,SAASA,QAAQ,CAAA;EAC5B,CAAA;AAGF,QAAMM,cAIFC,YACF,OAAOC,SAAAA;AACL,UAAMb,IAAkCX,UAAUwB,IAAAA;KAEpD;IACEC,YAAAA;AACErB,iBAAW,2BAAA;AACXS,aAAOa,QAAO;IAChB;IACAT,UAAAA;AACE,aAAOT,mBAAmB;QACxBU,MAAM;QACNC,SAASb,cAAc;UAAEc,IAAI;QAAqB,CAAA;MACpD,CAAA;IACF;EACF,CAAA;AAGF,SAAO;IACLP;IACAc,cAAcL;EAChB;AACF;",
  "names": ["useTracking", "trackUsage", "trackStrapiUsage", "useStrapiTracking", "data", "useSettings", "isAiAvailable", "useAIAvailability", "event", "properties", "isAIMediaLibraryConfigured", "Boolean", "aiMetadata", "endpoint", "pluginId", "queryKey", "useConfig", "trackUsage", "useTracking", "formatMessage", "useIntl", "toggleNotification", "useNotification", "get", "put", "useFetchClient", "config", "useQuery", "res", "data", "onError", "type", "message", "id", "select", "putMutation", "useMutation", "body", "onSuccess", "refetch", "mutateConfig"]
}
